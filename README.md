# 3D Graphics Engine with Hidden Surface Removal

Проект для визуализации 3D-моделей с удалением невидимых поверхностей и поддержкой камеры.

## Функциональность

### 1. Отсечение нелицевых граней (Backface Culling)
- **Автоматическое вычисление нормалей** для каждой грани через векторное произведение
- **Визуализация вращающихся объектов** с отсечением невидимых граней
- **Настройка вектора обзора** с возможностью изменения
- **Поддержка параллельной проекции**
- *Опционально: переключение между параллельной и перспективной проекцией*

### 2. Алгоритм Z-буфера
- **Реализация Z-буфера** для точного удаления невидимых поверхностей
- **Обработка перекрывающихся объектов**
- **Поддержка преобразований** объектов (перемещение, вращение, масштабирование)
- **Тестирование на выпуклых и невыпуклых объектах**

### 3. Система камеры
- **Объект-камера** с настраиваемыми параметрами:
  - Положение в пространстве
  - Направление обзора
  - Матрица проекционного преобразования
- **Вращение камеры** вокруг статического объекта
- **Перспективная проекция** для реалистичного отображения

## Использование

### Требования
- Python 3.7+
- PyOpenGL
- PyQt5/PySide2
- NumPy

### Запуск
```bash
python main.py
```

### Управление
- **ЛКМ + перемещение** - вращение камеры
- **ПКМ + перемещение** - перемещение камеры
- **Колесо мыши** - приближение/отдаление
- **Клавиши WASD** - движение камеры
- **Клавиши Q/E** - подъем/опускание камеры

## Реализованные алгоритмы

### Backface Culling
```python
def calculate_face_normal(vertex1, vertex2, vertex3):
    # Векторы в плоскости грани
    vector1 = vertex2 - vertex1
    vector2 = vertex3 - vertex1
    # Векторное произведение
    normal = np.cross(vector1, vector2)
    return normal / np.linalg.norm(normal)  # Нормализация

def is_face_visible(face_normal, view_direction):
    return np.dot(face_normal, view_direction) < 0
```

### Z-Buffer Algorithm
```python
class ZBuffer:
    def __init__(self, width, height):
        self.width = width
        self.height = height
        self.buffer = np.full((height, width), np.inf)
        self.color_buffer = np.zeros((height, width, 3))
    
    def update_pixel(self, x, y, z, color):
        if 0 <= x < self.width and 0 <= y < self.height:
            if z < self.buffer[y, x]:
                self.buffer[y, x] = z
                self.color_buffer[y, x] = color
```

### Camera System
```python
class Camera:
    def __init__(self):
        self.position = np.array([0.0, 0.0, 5.0])
        self.target = np.array([0.0, 0.0, 0.0])
        self.up = np.array([0.0, 1.0, 0.0])
        self.fov = 45.0
        self.aspect_ratio = 16/9
        self.near_plane = 0.1
        self.far_plane = 100.0
    
    def get_view_matrix(self):
        return look_at(self.position, self.target, self.up)
    
    def get_projection_matrix(self):
        return perspective(self.fov, self.aspect_ratio, 
                          self.near_plane, self.far_plane)
```

## Тестирование

### Модели для тестирования
- **cube.obj** - для проверки отсечения граней
- **sphere.obj** - для тестирования Z-буфера
- **multiple_objects.obj** - для демонстрации перекрытия

### Сценарии тестирования
1. **Вращение куба** - проверка корректности отсечения нелицевых граней
2. **Несколько перекрывающихся объектов** - демонстрация работы Z-буфера
3. **Облет камерой** вокруг сцены - тестирование системы камеры

## Структура проекта
```
src/
├── main.py                 # Главное приложение
├── camera.py              # Система камеры
├── backface_culling.py    # Отсечение нелицевых граней
├── z_buffer.py            # Реализация Z-буфера
├── renderer.py            # Рендерер OpenGL
├── shaders/               # Шейдеры GLSL
│   ├── vertex.glsl
│   └── fragment.glsl
└── models/                # Тестовые модели
    ├── cube.obj
    ├── sphere.obj
    └── scene.obj
```

## Настройки рендеринга

### Проекции
- **Параллельная** - для технической визуализации
- **Перспективная** - для реалистичного отображения

### Режимы отображения
- **Wireframe** - каркасное отображение
- **Solid** - заливка с удалением невидимых поверхностей
- **Textured** - текстурированные поверхности (*опционально*)

## Демонстрационные сцены
![Демонстрация работы]([https://user-images.githubusercontent.com/12345678/1234567890-animation.gif](https://media1.tenor.com/m/-Ll1dF4PMQ4AAAAC/кот-грызет-хрустит.gif))
### Сцена 1: Вращающийся куб
- Отсечение нелицевых граней
- Автоматическое вычисление нормалей
- Изменение направления обзора

### Сцена 2: Перекрывающиеся объекты
- Множество выпуклых тел
- Корректная работа Z-буфера
- Преобразования объектов

### Сцена 3: Облет камеры
- Вращение камеры вокруг статической сцены
- Перспективная проекция
- Плавное изменение обзора
